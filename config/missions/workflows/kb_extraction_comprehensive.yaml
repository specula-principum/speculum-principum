id: kb_extraction_comprehensive
goal: |
  Execute a comprehensive knowledge base extraction workflow from start to finish:
  
  Phase 1: Validation and Preparation (5-7 steps)
  - Fetch the extraction request issue
  - Validate that all required template fields are present
  - Check if source path/URL is accessible
  - Verify KB structure exists and is valid
  - Post status comment confirming validation
  
  Phase 2: Source Analysis (4-6 steps)
  - Scan the source document(s) for content
  - Generate a preview of what will be extracted
  - Identify document structure and sections
  - Determine appropriate KB category mapping
  
  Phase 3: Extraction Execution (5-8 steps)
  - Extract content from source into KB format
  - Apply taxonomy and metadata
  - Validate extracted content against schema
  - Check for duplicate or conflicting entries
  - Generate extraction report
  
  Phase 4: Quality Assurance (4-6 steps)
  - Run KB validation on extracted content
  - Check linking and cross-references
  - Verify metadata completeness
  - Generate quality metrics report
  
  Phase 5: Finalization (3-4 steps)
  - Post comprehensive report as issue comment
  - Apply completion labels
  - If quality checks pass, assign for human review
  - If issues found, request guidance on how to proceed
  
  The agent should use hierarchical planning to organize these phases,
  adapt based on intermediate results, and request human guidance if
  uncertainty is detected (e.g., ambiguous content, quality issues).

constraints:
  - Must complete all validation steps before proceeding to extraction
  - Cannot modify source documents
  - Must generate reports at each phase for transparency
  - Should request human guidance if confidence drops below 0.7
  - Must respect KB schema and taxonomy rules
  - Should use memory to learn from similar past extractions
  - Post progress updates every 5 steps

success_criteria:
  - All 5 phases completed successfully
  - Validation passed before extraction began
  - Extraction report shows content was successfully extracted
  - Quality validation shows no critical errors
  - Final report posted to issue with all metrics
  - Appropriate labels applied (kb-extracted, quality-checked, etc.)
  - Issue assigned for human review if ready
  - Agent demonstrates learning from past similar extractions

max_steps: 30

allowed_tools:
  - get_issue_details
  - search_issues_by_label
  - add_label
  - remove_label
  - post_comment
  - assign_issue
  - plan_kb_structure
  - list_required_kb_directories
  - load_mission_config
  - scan_source_document
  - preview_extraction
  - request_human_guidance

requires_approval: false
