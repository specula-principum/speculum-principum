# Mission to setup the repository configuration via an interactive issue.

id: setup_repo
version: 1
metadata:
  owner: copilot-orchestrator
  created_at: 2025-12-06
  summary_tooling: setup-workflow

goal: |
  Review the issue conversation to extract repository configuration details
  (Source URL, Topic, Frequency, Model).

  Actions Required:
  1. Fetch the full conversation history using `get_issue_comments` with the provided `issue_number`.
  2. Analyze the conversation for configuration details.
  3. If the Source URL is present, validate it using `validate_url`.
  4. If information is missing or the URL is invalid:
     - Post a comment asking the user to provide the missing details or correct the URL.
  5. If all information is present and valid:
     - Post a comment instructing GitHub Copilot to:
       "Configure the repository with Source URL: [URL], Topic: [Topic], Frequency: [Freq], Model: [Model].
       1. Create `config/manifest.json` with the following JSON structure:
          { \"source_url\": \"[URL]\", \"topic\": \"[Topic]\", \"frequency\": \"[Freq]\", \"model\": \"[Model]\" }
       2. Clean the `evidence/`, `knowledge-graph/`, and `reports/` directories (delete all files but keep `.gitkeep`).
       3. Create a new branch `setup-config`.
       4. Commit the changes.
       5. Call `configure_upstream_remote` to add the template repository as an upstream remote.
       6. Create a Pull Request."
     - Assign the issue to Copilot using `assign_issue_to_copilot`.

constraints:
  - Do NOT perform the setup actions (cleaning, configuring, committing) yourself. Delegate to Copilot.
  - Only assign to Copilot if the configuration is complete and valid.
  - If the user does not specify a model, default to "gpt-4o".

success_criteria:
  - Configuration details extracted and validated.
  - User requested for more info OR Copilot instructed and assigned.

max_steps: 5
allowed_tools:
  - validate_url
  - post_comment
  - assign_issue_to_copilot
  - get_issue_comments
  - configure_upstream_remote
requires_approval: false
