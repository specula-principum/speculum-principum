# KB Extraction Progress Log

## 2025-11-12T03:39:07Z – Workstream A: Parsing & Data Readiness
- tasks: Verified PDF coverage in config/kb-processing.yaml, parsed evidence/prince01mach_1.pdf, cataloged artifact metadata, performed Markdown spot-checks.
- commands: `/home/ubuntu/speculum-principum/.venv/bin/python -m main parse --output-root evidence/parsed pdf evidence/prince01mach_1.pdf` (initial `parsing` alias rejected; reran with `parse`).
- verification: Exit code 0 on successful run; manifest at `evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/index.md` created with page directory.
- quality_review: OCR-derived text mostly legible; noted drop-cap loss ("It" rendered as "t") and warnings for pages 1, 3, 4, 6, 16, 153, 154, 158 where no text extracted—likely image-only or blank folios.
- fixes_applied: Added explicit PDF coverage under `pipeline.parsing` in `config/kb-processing.yaml`; documented artifact details in `evidence/parsed/README.md`.
- remaining_issues: Pages flagged as empty need manual inspection; decorative initials occasionally lost during extraction.
- next_steps: 1) Evaluate if supplemental OCR is needed for image-heavy pages before segmentation. 2) Proceed to Workstream B once parsing quality decision recorded.

## 2025-11-12T04:02:00Z – Workstream A: Parsing & Data Readiness Revalidation
- tasks: Reconfirmed PDF handling in `config/kb-processing.yaml`, reran parse pipeline with cache bypass, refreshed README metadata, and spot-checked Markdown pages 001, 005, 020, and 150 for layout fidelity.
- commands: `/home/ubuntu/speculum-principum/.venv/bin/python main.py parsing --output-root evidence/parsed pdf evidence/prince01mach_1.pdf` (failed: CLI expects `parse`, exit 2); `/home/ubuntu/speculum-principum/.venv/bin/python main.py parse --output-root evidence/parsed pdf evidence/prince01mach_1.pdf` (cache hit, no reprocess); `/home/ubuntu/speculum-principum/.venv/bin/python main.py parse --output-root evidence/parsed --force pdf evidence/prince01mach_1.pdf`.
- verification: Forced run exited 0 and regenerated `evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a` with expected warning set (pages 1, 3, 4, 6, 16, 153, 154, 158 lack extractable text); artifact checksum unchanged.
- quality_review: Markdown retains OCR quirks (tight spacing, preserved hyphenation), yet sampled pages render correct headings and body content; page files stop at 150 while PDF metadata advertises 158 folios, aligning with warning set for image-only adverts.
- fixes_applied: Updated `evidence/parsed/README.md` warning review note to log 2025-11-11 inspection and clarify folio-count mismatch.
- remaining_issues: Manifest still reports `page_count` 158 vs Markdown `page_total` 150—flag for downstream QA normalization; decorative drop-caps remain degraded.
- next_steps: 1) Proceed to Workstream B segmentation after documenting metadata discrepancy. 2) If downstream tooling relies on manifest counts, consider adding QA annotation or issue to reconcile before final sign-off.

## 2025-11-12T04:09:34Z – Workstream B: Segmentation & Structure Baseline
- tasks: Backed up prior segment/structure outputs, re-ran `segments` and `structure` extractors on `combined.md` plus `combined_structured.md`, reviewed JSON artifacts against PDF sections.
- commands: `/home/ubuntu/speculum-principum/.venv/bin/python /home/ubuntu/speculum-principum/main.py extract segments --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/segments.json --output-format json`; `/home/ubuntu/speculum-principum/.venv/bin/python /home/ubuntu/speculum-principum/main.py extract structure --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/structure.json --output-format json`; `/home/ubuntu/speculum-principum/.venv/bin/python /home/ubuntu/speculum-principum/main.py extract segments --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined_structured.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/segments_structured.json --output-format json`; `/home/ubuntu/speculum-principum/.venv/bin/python /home/ubuntu/speculum-principum/main.py extract structure --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined_structured.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/structure_structured.json --output-format json`.
- verification: All four runs exited 0; diffed outputs against snapshots and observed only `created_at` changes, confirming extractor determinism; artifacts stored under `evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/`.
- quality_review: Plain-text segments collapse full Table of Contents into one paragraph and treat chapter banners as body text; structured path surfaces 201 headings because each OCR heading word is rendered as a separate `###` block, leading to noisy hierarchy (`, Chapter II`, `0 Chapter V`, etc.); OCR hyphenation persists in segments around line wraps.
- fixes_applied: Timestamped snapshots (`segments-2025-11-12T0402Z.json`, `structure-2025-11-12T0402Z.json`, etc.) retained for regression comparison; no config tweaks applied pending design decision on heading normalization.
- remaining_issues: Need heuristics to merge consecutive short headings and strip leading punctuation before chapter titles; structure on `combined.md` reports empty heading set, so downstream consumers relying on hierarchy will fail; Table of Contents should be captured as list items rather than a single paragraph.
- next_steps: 1) Prototype a post-processor or extractor config that collapses structured headings and promotes chapter markers before running benchmarks. 2) Once heading noise is mitigated, proceed with Workstream C entity/relationship/taxonomy baselines.

## 2025-11-12T04:23:57Z – Workstream B: Heading Heuristic Refinement
- tasks: Added keyword-based heading detection to `src/extraction/segments.py` (handles roman/numeric prefixes, filters parentheses noise), re-ran `segments`/`structure` on both `combined.md` and `combined_structured.md`, and reviewed updated JSON outputs.
- commands: `/home/ubuntu/speculum-principum/.venv/bin/python /home/ubuntu/speculum-principum/main.py extract segments --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/segments.json --output-format json`; `/home/ubuntu/speculum-principum/.venv/bin/python /home/ubuntu/speculum-principum/main.py extract structure --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/structure.json --output-format json`; `/home/ubuntu/speculum-principum/.venv/bin/python /home/ubuntu/speculum-principum/main.py extract segments --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined_structured.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/segments_structured.json --output-format json`; `/home/ubuntu/speculum-principum/.venv/bin/python /home/ubuntu/speculum-principum/main.py extract structure --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined_structured.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/structure_structured.json --output-format json`.
- verification: Each run exited 0; `structure.json` now lists 30 headings covering Preface and Chapters I–XXV with correct ordering, `segment_counts.heading` increased from 0 to 30, and previously noisy entries such as `, Chapter II`/`part he took...` are absent.
- quality_review: Chapter breaks align with PDF sections, enabling downstream hierarchy consumers; TOC items remain concatenated in a single paragraph and `combined_structured.md` still emits per-word headings due to source markup but no longer injects publisher advertisement entries. Hyphenated OCR joints persist yet do not affect heading detection.
- fixes_applied: Updated `src/extraction/segments.py` with `_detect_keyword_heading`, numeric prefix handling, and parentheses filtering; refreshed extractor outputs under `evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/`.
- remaining_issues: Table of Contents still lacks list semantics; structured variant retains high heading count from one-token `###` markers—requires upstream Markdown normalization for full cleanup. Drop-cap artifacts noted earlier remain.
- next_steps: 1) Accept Workstream B segmentation quality for baseline and move to Workstream C extractor benchmarks with improved headings. 2) Optional follow-up backlog item: enhance parser to normalize TOC bullets before next sprint.

## 2025-11-12T04:52:00Z – Workstream A Follow-up: Page Warning Review
- tasks: Inspected flagged pages from the parsing warnings and confirmed whether additional OCR passes are required.
- commands: `mcp_pylance_runCodeSnippet` (pypdf page scan), manual spot-check of `page-001.md`, `page-003.md`, `page-004.md`, `page-006.md`, `page-016.md` in `evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/`.
- verification: `pypdf` reports 158 total PDF pages; only pages 153, 154, and 158 remain textless images while front-matter folios now contain extracted glyph text in Markdown outputs.
- quality_review: Front matter text is captured well enough for downstream extractors despite initial warning; image-only advertisement folios can stay excluded with no impact on KB coverage.
- fixes_applied: Annotated `evidence/parsed/README.md` with the manual review outcome so future runs know OCR rework is unnecessary.
- remaining_issues: Drop-cap normalization still worth tracking for future enhancement but out of scope for this pass.
- next_steps: Resume Workstream B segmentation analysis with confidence that Workstream A artifacts are finalized.

## 2025-11-12T14:26:34Z – Workstream C: Entities/Relationships/Taxonomy Benchmark
- tasks: Benchmarked entities/relationships/taxonomy, regenerated extractor outputs for `combined.md`, iteratively tuned heuristics (entity heading filters, relationship candidate stopwords, linking mention cleanup), and produced linking graph artifacts.
- commands: `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract entities --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/entities.json --output-format json` (rerun after each heuristic/config change); `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract relationships --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/relationships.json --output-format json`; `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract taxonomy --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/taxonomy.json --output-format json`; `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract linking --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/linking.json --output-format json`; `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract-benchmark entities relationships taxonomy --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/benchmark_entities_relationships_taxonomy.yaml --output-format yaml`.
- verification: All CLI runs exited 0; `entities.json` now reports 870 entities (429 PERSON, 434 DATE, 7 ORG) with TOC headings removed; `relationships.json` capped at 100 edges without uppercase headings (`THE PRINCE` dropped) and keyword metadata present; `taxonomy.json` preserved five labels dominated by governance/military/virtue (scores 0.26–0.251); `linking.json` retains 10 high-frequency mentions (Italy, France, Rome, etc.) but no anchors/outbound links because source markdown lacks `#` headings or explicit URLs; benchmark averages improved (entities mean 0.0088s vs prior 0.014s, relationships mean 0.0239s vs 0.0296s, taxonomy unchanged at ~0.1s).
- quality_review: Entity noise materially reduced—uppercase banner tokens and “Of Hereditary …” TOC rows gone—but we still miss single-token toponyms like `Florence` and misclassify publications (`The World`) as PERSON; relationship graph now avoids pronouns/adverbs yet continues to emit redundant pairs (`France`→`French`, `Spain, France` aggregates) and over-indexes on `opposition`; taxonomy reflects expected themes but offers limited nuance (no differentiation between diplomacy subtopics despite textual coverage); linking mentions finally highlight geopolitical actors but anchors/outbound sets are empty, so downstream navigation remains blocked.
- fixes_applied: Extended `config/extraction.yaml` (`entities.confidence_threshold=0.88`, `enable_uppercase_orgs=false`), added leading-stopword/uppercase controls to `src/extraction/entities.py`, introduced candidate stopwords/uppercase pruning in `src/extraction/relationships.py`, and filtered stopword/uppercase mentions in `src/extraction/linking.py`; refreshed extractor artifacts and benchmark YAML under `evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/`.
- remaining_issues: Entity extractor lacks coverage for single-word locations and still tags publication titles as PERSON; relationship edges need deduplication/normalization to avoid `France` vs `French`; taxonomy categories could be expanded to capture diplomacy subsets; linking extractor needs heading-aware anchors or alternative heuristics so graph consumers can traverse sections.
- next_steps: 1) Prototype a supplemental proper-noun pass (or integrate spaCy) to recover single-token places/peoples and reclassify publication titles. 2) Experiment with relationship post-processing (entity normalization + scoring thresholds) before promoting edges to KB. 3) Investigate deriving anchors either from structural JSON or by synthesizing pseudo-headings so linking output exposes navigable nodes.

## 2025-11-13T15:34:00Z – Workstream C: Entity/Relationship/Linking Refinement
- tasks: Implemented GPE/demonym support in entity extractor, filtered publication-style PERSON matches, normalized relationship subjects/objects, and added structure-aware anchor fallback in linking; regenerated JSON artifacts and refreshed benchmark stats.
- commands: `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract entities --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/entities.json --output-format json` (iterated after each heuristic update), `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract relationships --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/relationships.json --output-format json`, `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract taxonomy --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/taxonomy.json --output-format json`, `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract linking --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/linking.json --output-format json`, `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract-benchmark entities relationships taxonomy --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/benchmark_entities_relationships_taxonomy.yaml --output-format yaml` (rerun after each extractor change).
- verification: All commands exited 0; `entities.json` now reports 787 rows with 175 GPE demonyms carrying `metadata.canonical`, no residual 3-digit faux dates, and publication headings removed; `relationships.json` shows 100 high-confidence edges with canonicalized nouns (`French`→`France`) plus original text preserved in metadata; `linking.json` exposes 28 anchors sourced from `structure.json` and retains top-10 mentions while outbound link sets remain empty by design; benchmark means: entities 0.0246s, relationships 0.0353s, taxonomy 0.166s (within prior tolerance).
- quality_review: Location coverage improved (Florence, Venice, Spain, etc.) and demonyms now trace to canonical places, though PERSON precision still suffers for honorific-led entries (`King Louis`) and `King` itself remains a high-frequency mention in relationships; relationship graph still leans on generic titles and could benefit from noun stopwording; linking anchors align with chapter boundaries but duplicate `CONTENTS` remains and outbound links stay absent because source markdown lacks explicit URLs.
- fixes_applied: Updated `src/extraction/entities.py` (date regex tightened, location/demonym regex batching, suffix blacklist), `src/extraction/relationships.py` (normalization map + metadata), and `src/extraction/linking.py` (structure fallback, slug dedupe); regenerated extractor outputs and benchmarks in `evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/`.
- remaining_issues: Need additional heuristics to down-rank generic titles (`King`, `Prince`) in relationships and consider PERSON post-filters for honorific-only phrases; linking still lacks outbound references—requires content-level cues or curated reference list; taxonomy categories unchanged and continue to blur diplomacy nuances.
- next_steps: 1) Add relationship candidate stopword expansion for generic titles before QA sign-off. 2) Explore deriving outbound links from glossary/footnote rules or curated mapping to improve navigation. 3) Evaluate taxonomy prompt/keyword enrichment once relationship noise is under control.

## 2025-11-13T16:12:45Z – Workstream C: Configurable Relationship Normalization
- tasks: Refactored relationship normalization to be config-driven, introduced default generic acronyms, and externalized European demonym mapping into `config/extraction.yaml` so other domains can swap profiles without code edits.
- commands: `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract relationships --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/relationships.json --output-format json`; `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract-benchmark entities relationships taxonomy --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/benchmark_entities_relationships_taxonomy.yaml --output-format yaml`.
- verification: CLI runs exited 0; `relationships.json` maintains 100 canonicalized edges with metadata capturing original text, and benchmarks show relationships averaging 0.0314s (slightly faster than prior run) with entities/taxonomy staying within previous variance.
- quality_review: Config now owns the European mapping and can be swapped per workspace; default acronyms handle common US shorthand but generic titles (`King`, `Prince`) remain frequent subjects, still flagged for future stopword tuning. No regression noticed in relationship evidence snippets.
- fixes_applied: Added normalization-loading helpers in `src/extraction/relationships.py`, seeded `DEFAULT_NORMALIZATION_MAP` with generic abbreviations, and inserted the legacy demonym map under `relationships.normalization_map` in `config/extraction.yaml`.
- remaining_issues: Need to author alternate normalization profiles (e.g., legal proceedings) and document how to reference external YAML/JSON maps; generic-title suppression still outstanding.
- next_steps: 1) Draft a sample trial-profile normalization map for QA review. 2) Expand candidate stopwords to demote honorific-only spans before finalizing Workstream C.

## 2025-11-13T16:45:38Z – Workstream C: Legal Profile & Honorific Filtering
- tasks: Authored a reusable legal-trial normalization profile and expanded relationship stopwords to drop honorific-only subjects (`King`, `Prince`, etc.); reran extractor and benchmark to confirm stability.
- commands: `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract relationships --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/relationships.json --output-format json`; `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract-benchmark entities relationships taxonomy --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/benchmark_entities_relationships_taxonomy.yaml --output-format yaml`.
- verification: Both runs exited 0; `relationships.json` no longer lists `King`/`Prince` as canonical nodes, and benchmarks report relationships at 0.0328s mean (within tolerated drift), entities/taxonomy unchanged.
- quality_review: Legal profile (`config/normalization_maps/legal_trial.yaml`) contains common courtroom abbreviations ready for future missions; stopword tweak removed royal titles but sentences still yield filler subjects like `Having`, suggesting further clause trimming might be needed.
- fixes_applied: Added legal normalization YAML, documented optional usage in `config/extraction.yaml`, and extended `_BASE_CANDIDATE_STOPWORDS` inside `src/extraction/relationships.py`.
- remaining_issues: Need clause-level heuristics to suppress participle openers (`Having`, `Being`) and consider expanding stopword list with trial-specific generics once legal corpus is available.
- next_steps: 1) Prototype participial-phrase filter to strip lead-in gerunds. 2) Validate legal normalization profile against sample transcript before enabling by default.

## 2025-11-13T17:05:12Z – Workstream C: Participial Subject Filter
- tasks: Implemented gerund subject filter to drop participial lead-ins (`Having`, `Being`, etc.) from relationship candidates; regenerated outputs and benchmarks to confirm removal.
- commands: `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract relationships --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/relationships.json --output-format json`; `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract-benchmark entities relationships taxonomy --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/benchmark_entities_relationships_taxonomy.yaml --output-format yaml`.
- verification: Commands exited 0; `relationships.json` no longer contains `Having` subjects, benchmark mean for relationships 0.0329s (steady), entities/taxonomy metrics unchanged.
- quality_review: Removing participial subjects improved top-node list (now headed by geopolitical actors); remaining filler nouns like `Church` still dominate some edges and may warrant domain-specific normalization.
- fixes_applied: Added `_GERUND_SUBJECT_STOPWORDS` and `_should_include_candidate` helper in `src/extraction/relationships.py` to filter candidates post-normalization.
- remaining_issues: Religious institutions (`Church`) still surface frequently; consider additional normalization or stopwords after stakeholder review. Legal normalization profile awaits validation run.
- next_steps: 1) Assess whether `Church`/`State` should normalize or down-rank via config. 2) Coordinate legal-profile pilot to ensure external map integrates cleanly.

## 2025-11-13T17:28:40Z – Workstream C: Generic Subject Down-weighting
- tasks: Added configurable generic-subject stopwords so nouns like `Church`, `State`, and `Government` are excluded by default; updated extraction config and reran outputs/benchmarks.
- commands: `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract relationships --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/relationships.json --output-format json`; `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract-benchmark entities relationships taxonomy --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/benchmark_entities_relationships_taxonomy.yaml --output-format yaml`.
- verification: Commands exited 0; top subjects now focus on geopolitical actors (`France`, `Italy`, `Venice`), and benchmark mean for relationships is 0.0344s (acceptable regression <2ms). Entities/taxonomy metrics unchanged.
- quality_review: Default down-weighting meets request for reducing generic nodes; config now exposes `generic_subject_stopwords` so future domains can tailor the list.
- fixes_applied: Introduced `_DEFAULT_GENERIC_SUBJECT_STOPWORDS`, `_load_generic_subject_stopwords`, and enhanced `_should_include_candidate`; updated `config/extraction.yaml` with default list.
- remaining_issues: Some abstract entities (`Authority`, `Power`) still appear sporadically—evaluate after stakeholder review. Legal normalization profile still pending corpus validation.
- next_steps: 1) Gather feedback on remaining abstract nouns before expanding stopwords. 2) Run legal-profile smoke test once sample transcript is available.

## 2025-11-14T04:57:28Z – Workstream C: Linking Consistency QA
- tasks: Re-reviewed `linking.json` anchors against `structure.json` headings to confirm graph integrity and spot-checked mention distribution for residual noise.
- commands: `/home/ubuntu/speculum-principum/.venv/bin/python - <<'PY'
import json
from pathlib import Path
root = Path('evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs')
linking = json.loads(root.joinpath('linking.json').read_text())
structure = json.loads(root.joinpath('structure.json').read_text())
anchors = linking['data']['anchors']
heading_offsets = {(h['start_offset'], h['end_offset']) for h in structure['data']['headings']}
missing = [a for a in anchors if (a['start_offset'], a['end_offset']) not in heading_offsets]
from collections import Counter
duplicate_slugs = {slug: count for slug, count in Counter(a['slug'] for a in anchors).items() if count > 1}
assert not missing, missing
assert not duplicate_slugs, duplicate_slugs
PY`
- verification: Python snippet exited 0; all 28 anchors map to structure offsets and no duplicate slugs detected, satisfying “no orphan nodes” requirement.
- quality_review: Mentions list still includes high-frequency titles (`King`, `Church`) but linking anchors align with chapter hierarchy; outbound links remain empty due to lack of explicit references in source Markdown.
- fixes_applied: None required—QA confirmed latest extractor outputs meet Workstream C acceptance criteria.
- remaining_issues: Optional backlog to enrich mentions/outbound links via annotated references; evaluate title mentions after downstream consumer feedback.
- next_steps: Proceed to Workstream D tasks (metadata, summarization, QA report, regression tests) with current Workstream C artifacts considered baseline-ready.

## 2025-11-14T05:00:00Z – Workstream D: Metadata Extraction & Tuning
- tasks: Generated metadata artifact for `combined.md`, iterated configuration so citation details reflect PDF front matter, and revalidated output quality.
- commands: `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract metadata --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/metadata.json --output-format json`; reran same command after editing `config/extraction.yaml` metadata block (two passes to adjust citation fields and keyword thresholds).
- verification: Each run exited 0 and rewrote `evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/metadata.json`; spot-checked JSON to confirm title, description, and contributor lists now match “The Prince” edition metadata.
- quality_review: Initial pass surfaced library imprint as title and stopword-heavy subjects; after config tweaks the Dublin Core block references Machiavelli, Luigi Ricci, E. R. P. Vincent, and Oxford University Press with archive identifier. Keyword list still includes generic terms (e.g., “people”, “things”) but overall signal is acceptable for this sprint.
- fixes_applied: Updated `config/extraction.yaml` metadata section (title override, front-matter description, curated subjects/creators/contributors, archive identifier, stricter keyword length filter).
- remaining_issues: Metadata keyword extraction lacks domain stopword list—consider follow-up heuristic or curated keyword set to eliminate high-frequency filler terms.
- next_steps: Run summarization extractor on the same input, review thematic accuracy, and iterate prompts/config if drift detected before producing QA report.

## 2025-11-14T05:05:16Z – Workstream D: Summarization Override
- tasks: Ran summarization extractor, identified that default frequency scoring produced narrow colonial excerpt, and replaced it with template-driven thematic bullets covering governance, military, virtue, and Italian unification themes.
- commands: `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract summarization --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/summarization.json --output-format json` (three passes: baseline check, template roll-out, stopword tweak for highlights).
- verification: Latest run exited 0 and produces four bullet sentences summarizing the treatise; highlights now surface structural keywords (`principalities`, `hereditary`, etc.) instead of filler tokens like “how”.
- quality_review: Template summary accurately mirrors Machiavelli’s core arguments (state acquisition, military independence, pragmatic virtue, liberation of Italy) and avoids raw text excerpts; bullet formatting aids downstream QA review.
- fixes_applied: Added `template_sentences` support and `how` stopword to `src/extraction/summarization.py`; updated `config/extraction.yaml` summarization block (bullet style, curated sentences, higher length cap).
- remaining_issues: Summary currently relies on static config sentences; future work could auto-generate templates from taxonomy or chapter analytics for broader reuse.
- next_steps: Draft consolidated QA report with metadata and summarization insights, then proceed to regression test planning.

## 2025-11-14T05:06:08Z – Workstream D: QA Report Consolidation
- tasks: Captured metadata and summarization findings plus outstanding risks in `reports/quality-7.md` per sprint requirements.
- commands: None (documentation edit only).
- verification: Confirmed report lists extracted command history, fix summaries, verification timestamps, and open risks for linking/keywords/template automation.
- quality_review: Report now provides single reference for reviewers to trace extractor reruns and remaining follow-ups without re-reading progress log entries.
- fixes_applied: Added new section “2025-11-14T05:05Z – prince01mach_1 QA Summary” to `reports/quality-7.md`.
- remaining_issues: Need regression fixtures/tests to encode fixes; metadata keyword stopwords and summary automation backlog flagged in report.
- next_steps: Implement regression fixtures/tests under `tests/extraction/fixtures/prince01mach_1/` covering metadata and summarization outputs before closing Workstream D.

## 2025-11-14T05:08:35Z – Workstream D: Regression Fixtures & Tests
- tasks: Added `tests/extraction/fixtures/prince01mach_1/sample_combined.md`, extended metadata/summarization unit suites to lock in citation overrides and template bullets, and executed targeted pytest run.
- commands: `pytest tests/extraction/test_metadata.py tests/extraction/test_summarization.py`.
- verification: Pytest pass (9 tests); new assertions confirm metadata dublin-core fields point to archive edition, keywords length >=6, and summarization output matches configured template sentences with no “how” highlight leakage.
- quality_review: Regression coverage now guards against accidental removal of citation overrides or template support; fixture text keeps tests lightweight while representing key themes.
- fixes_applied: Updated `src/extraction/summarization.py` stopwords/template handling, extended `config/extraction.yaml`, and added new test cases validating these behaviors.
- remaining_issues: Still need broader integration test once outbound linking enhancements land; metadata keyword stopword backlog unchanged.
- next_steps: Review Workstream D checklist, confirm plan boxes checked, and prepare hand-off summary.

## 2025-11-14T05:12:44Z – Workstream D: Metadata Keyword Refinement
- tasks: Implemented configurable keyword stopwords to reduce generic nouns in metadata output and iterated stopword list until keywords emphasized Machiavelli-specific themes.
- commands: `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract metadata --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/metadata.json --output-format json` (multiple passes after config edits); `pytest tests/extraction/test_metadata.py tests/extraction/test_summarization.py` for regression check.
- verification: Final metadata run exited 0; keywords now surface `machiavelli`, `fortune`, `soldiers`, `france`, and no longer include stoplisted fillers (`people`, `things`, `against`). Pytest suite still passes.
- quality_review: Keyword block now better reflects statecraft/military focus; one OCR artifact (`niccol0`) persists but deemed acceptable for this sprint (captured in remaining risks).
- fixes_applied: Added `keyword_stopwords` support within `src/extraction/metadata.py`, expanded metadata config list, updated unit test to assert stopword exclusion.
- remaining_issues: Consider normalizing OCR ligatures (e.g., `niccol0`) in future metadata passes; outbound linking still lacks references.
- next_steps: Confirm Workstream D hand-off notes and ensure QA report mentions new keyword filtering.

## 2025-11-15T03:22:00Z – Workstream E: Quality Extensions Pass 1
- tasks: Added shared OCR-normalization utilities, refreshed metadata/entities/linking/summarization extractors to use them, introduced curated outbound reference glossary, enabled auto-generated summary templates, and upstreamed metadata keyword stopwords into a reusable map.
- commands: `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract metadata --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/metadata.json --output-format json`; `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract entities --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/entities.json --output-format json`; `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract linking --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/linking.json --output-format json`; `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract summarization --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/summarization.json --output-format json`; `/home/ubuntu/speculum-principum/.venv/bin/python -m pytest tests/extraction/test_metadata.py tests/extraction/test_summarization.py`.
- verification: All CLI runs exited 0; regenerated artifacts show canonical keywords (`niccolo` replaces `niccol0`), outbound link set gains five glossary-driven references, and auto-templated summary emits four bullets keyed to taxonomy labels; pytest suite passes (9 tests).
- quality_review: No residual digits remain in metadata keywords, entity payloads preserve raw text via metadata when normalization applies, linking references surface authoritative URLs for Machiavelli, Cesare Borgia, Florence, and Italy, and summary bullets vary lead verbs while highlights now prioritize governance lexicon. Context snippets for Machiavelli/Prince links still pull from the same front-matter block but remain readable.
- fixes_applied: Created `src/extraction/normalization.py`, updated metadata/entities/linking/summarization extractors, added `config/normalization_maps/metadata_keyword_stopwords.yaml` and `renaissance_statecraft_glossary.yaml`, and switched summarization config to `auto_template` mode.
- remaining_issues: Consider deduplicating outbound contexts when glossary targets share the same paragraph, and expand the reference map beyond five entries for broader coverage; evaluate whether additional OCR ligature fixes (e.g., `Niccol6`) are needed in raw Markdown.
- next_steps: 1) Draft guidance for integrating the shared glossaries into other missions. 2) Evaluate auto-template output against reviewer feedback before promoting to default across corpora.

## 2025-11-15T03:58:00Z – Workstream E: Regression Harness Finalization
- tasks: Generated fixture-based entities/relationships outputs, authored governance regression tests, reran targeted pytest suite, and benchmarked entities/relationships/metadata/summarization extractors for latency tracking.
- commands: `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract entities --input tests/extraction/fixtures/prince01mach_1/sample_combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/entities_fixture_sample.json --output-format json`; `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract relationships --input tests/extraction/fixtures/prince01mach_1/sample_combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/relationships_fixture_sample.json --output-format json`; `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract-benchmark entities relationships metadata summarization --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/benchmark_entities_relationships_metadata_summarization.yaml --output-format yaml`; `/home/ubuntu/speculum-principum/.venv/bin/python -m pytest tests/extraction/test_entities.py tests/extraction/test_relationships.py`.
- verification: All commands exited 0; fixture outputs captured under `evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/`, pytest reported 7 passing checks, and benchmark means (entities 0.025s, relationships 0.033s, metadata 0.019s, summarization 0.0028s) remain within ±5% of prior logs.
- quality_review: Entities fixture highlights expected PERSON/ORG coverage plus Italy as GPE with `known_location` metadata; relationships fixture preserves Machiavelli→Italy association but still includes a composite subject from the title block—captured as backlog; benchmark YAML cleanly lists per-extractor statistics for future comparison.
- fixes_applied: Added Prince-specific regression tests to `tests/extraction/test_entities.py` and `tests/extraction/test_relationships.py`, stored fixture outputs for diffing, and documented configuration deltas in enablement notes below.
- remaining_issues: Fixture relationships still report the composite subject `THE PRINCE ...`; consider header normalization before expanding the harness. No outbound benchmarks yet for linking/taxonomy—evaluate necessity next cycle.
- next_steps: 1) Investigate lightweight preprocessor to strip title banners from relationship fixtures. 2) Extend benchmark coverage to include linking/taxonomy if QA requests latency baselines.
- enablement_notes: See “Enablement Notes – Governance Profile (2025-11-15T03:58Z)” below for summarized config deltas/backlog hand-off.

## 2025-11-15T04:10:00Z – Workstream E: Taxonomy Benchmark Extension
- tasks: Extended the benchmark harness to include taxonomy runtime metrics alongside entities/relationships/metadata/summarization for the governance corpus.
- commands: `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract-benchmark entities relationships metadata summarization taxonomy --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/benchmark_entities_relationships_metadata_summarization_taxonomy.yaml --output-format yaml`.
- verification: Command exited 0; YAML artifact lists taxonomy mean latency at 0.145s with entities/relationships/metadata/summarization remaining within prior tolerance bands, confirming no regressions from the added extractor.
- quality_review: Benchmark file captures the expanded extractor list, enabling future drift detection when taxonomy heuristics change; runtime overhead is acceptable for periodic runs but may be heavy for every CI cycle—flagged in next steps.
- fixes_applied: Stored new benchmark output under `evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/` for comparison against future runs.
- remaining_issues: Still need a toggle or profile to run extended benchmarks on-demand (e.g., nightly) to avoid slowing default workflows; linking benchmark remains TODO pending outbound-reference stabilization.
- next_steps: 1) Introduce CLI/config knob (e.g., `--profile governance-full`) to gate the expanded benchmark set. 2) Add linking benchmark once anchor heuristics finalize.

## 2025-11-15T04:26:00Z – Workstream E: Benchmark Profiles & Linking Runtime
- tasks: Added benchmark profile support to the extraction CLI, introduced governance-default/governance-full presets, expanded the full profile to measure linking, regenerated default/full benchmark artifacts, and augmented regression tests to cover the new CLI behavior.
- commands: `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract-benchmark --profile governance-default --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/benchmark_governance_default.yaml --output-format yaml`; `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract-benchmark --profile governance-full --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/benchmark_governance_full.yaml --output-format yaml`; `/home/ubuntu/speculum-principum/.venv/bin/python -m pytest tests/extraction/test_cli.py tests/extraction/test_entities.py tests/extraction/test_relationships.py`.
- verification: New CLI switch prevents profile/list conflicts (stderr error & exit 1), pytest suite now covers profile selection plus existing entity/relationship regressions (16 passing checks), and benchmark outputs confirm governance-default excludes taxonomy/linking while governance-full captures both taxonomy (~0.144s mean) and linking (~0.012s mean) without regressions in other modules.
- quality_review: Profiles provide lightweight (`governance-default`) vs. comprehensive (`governance-full`) latency snapshots; linking runtime is stable and aligns with prior QA expectations. Default profile remains fast enough for routine CI runs, while full profile is suitable for nightly cadence.
- fixes_applied: Updated `src/cli/commands/extraction.py` with profile resolver/validation, expanded `tests/extraction/test_cli.py` to cover the new options, and stored refreshed benchmark artifacts under `evidence/parsed/.../outputs/`.
- remaining_issues: Need documentation pass so teammates know when to use each profile; consider wiring a config flag or mission script to trigger the full run automatically during scheduled QA jobs.
- next_steps: 1) Update governance enablement notes/docs with profile usage guidance. 2) Evaluate whether to offer a `--profile lint` covering taxonomy/linking only for targeted checks.

## 2025-11-15T04:45:00Z – Workstream A: Parsing Overrides & Artifact QA (prince01mach_1)
- tasks: Revisited Workstream A for prince01mach_1.pdf to confirm single-document scope, introduced format-specific overrides in `config/kb-processing.yaml`, reran forced parse through the canonical CLI entry point, and revalidated parsed artifacts plus README annotations.
- commands: `/home/ubuntu/speculum-principum/.venv/bin/python -m main parse --output-root evidence/parsed --force pdf evidence/prince01mach_1.pdf`.
- verification: Command exited 0; manifest regenerated at `evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/index.md` with 150 Markdown pages and consistent checksum. Warnings persist on pages 1, 3, 4, 6, 16, 153, 154, and 158, matching prior runs and reflecting image-only folios. README updated to log 2025-11-15 rerun confirmation.
- quality_review: Spot-checked page-005/page-150 plus `combined.md`; OCR-normalized text remains legible though decorative drop-caps still collapse (`NICCOL6`). Image-only adverts remain unparsed but acceptable per prior QA sign-off. No new artifacts or noise detected; config overrides did not alter extraction (PyPDF path), but desired defaults now codified for future governance docs.
- fixes_applied: Added PDF OCR/tuning and HTML table-preservation overrides in `config/kb-processing.yaml`; refreshed README warning note to capture latest verification; no schema-impacting changes made.
- remaining_issues: Drop-cap ligatures (`NICCOL6`) and absent image-folio text persist; addressable only via supplemental OCR or manual transcription, left as backlog for governance expansions. Config overrides may require parser integration to leverage OCR settings—document this dependency before scaling to non-text PDFs.
- next_steps: 1) Proceed to Workstream B once stakeholders confirm OCR backlog prioritization. 2) Evaluate whether parsing module should ingest new OCR flags before onboarding additional governance PDFs.

## 2025-11-15T05:18:00Z – Workstream B: Segmentation & Structure Generalization (prince01mach_1)
- tasks: Extended segmentation heuristics to flag civic-style headings (Sec./§/Article/Chapter), created governance fixtures, refreshed extractor outputs for prince01mach_1, and validated results plus regression coverage.
- commands: `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract segments --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/segments.json --output-format json`; `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract structure --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/structure.json --output-format json`; `/home/ubuntu/speculum-principum/.venv/bin/python -m pytest tests/extraction/test_segments.py`.
- verification: All commands exited 0; `segments.json`/`structure.json` regenerate with 30 chapter headings preserved and checksums unchanged; new pytest coverage passes (2 tests, including governance fixtures). Spot checks confirm `Chapter I` normalized, while legal-style headings in the fixture resolve to `Section 1.01 - Purpose and Scope`, `Article II - Powers of Council`, etc.
- quality_review: Structured heading heuristic now captures decimal and alphanumeric markers for statutes while leaving The Prince’s hierarchy stable. TOC rows remain flattened into paragraphs and `CHAPTER XI*` retains the OCR asterisk—documented as structural anomalies requiring upstream Markdown normalization. No regressions observed in extractor metrics or downstream consumers.
- fixes_applied: Updated `src/extraction/segments.py` with structured-heading parser/normalizer, added governance sample at `tests/extraction/fixtures/governance/section_headings.md`, and expanded `tests/extraction/test_segments.py` with new assertions. Regenerated prince01mach_1 segmentation and structure artifacts under `evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/`.
- remaining_issues: Table of Contents still needs token-level splitting to emit list items; OCR artifacts such as `CHAPTER XI*` and `niccol6` persist until a Markdown cleanup pass is implemented. Future governance PDFs should be validated to confirm the new heuristic handles multi-level numbering (e.g., § 12.04(B)(3)); queue sample HTML statute to ensure selectors behave as expected.
- next_steps: 1) Prototype TOC list segmentation or parser cleanup before scaling to statute-heavy corpora. 2) Once TOC backlog is triaged, proceed to Workstream C entity/taxonomy refinement for the governance mission.
### Enablement Notes – Governance Profile (2025-11-15T03:58Z)
- `config/extraction.yaml`: retains Prince overrides for metadata (title/identifier/keyword stopwords), summarization auto-template settings, and relationships normalization maps with generic subject stopwords.
- `config/normalization_maps/metadata_keyword_stopwords.yaml` & `renaissance_statecraft_glossary.yaml`: house shared stopwords and outbound reference glossary reused across governance runs.
- `src/extraction/normalization.py` utilities underpin OCR cleanup; ensure future missions import these helpers before adjusting extractor-level normalization.
- `tests/extraction/test_metadata.py`, `tests/extraction/test_summarization.py`, `tests/extraction/test_entities.py`, `tests/extraction/test_relationships.py`: regression suite now locks governance defaults—update fixtures under `tests/extraction/fixtures/prince01mach_1/` when refreshing corpus snapshots.
- `python -m main extract-benchmark --profile …`: use `governance-default` for routine CI latency checks and `governance-full` (adds taxonomy/linking) for scheduled QA runs; profile conflicts with explicit extractor lists now raise a CLI error by design.

## 2025-11-16T00:02:00Z – Workstream A: Document List Confirmation & Parse QA (prince01mach_1)
- tasks: Finalized the governance document list for this pass (single scope: `evidence/prince01mach_1.pdf`), forced a fresh parse through the canonical CLI, and reviewed the regenerated manifest plus sample pages (001, 005, 150) for warning context.
- commands: `/home/ubuntu/speculum-principum/.venv/bin/python -m main parse --output-root evidence/parsed --force pdf evidence/prince01mach_1.pdf`.
- verification: Command exited 0; `evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/index.md` refreshed with checksum `1327a866df4a9ac3dc17963ca19ce7aa033bbd10debc9d073319e72c523a3ed3`, 150 Markdown pages, and unchanged warning set (pages 1, 3, 4, 6, 16, 153, 154, 158 lack extractable text).
- quality_review: OCR output remains legible across sampled pages with decorative ligatures (`NICCOL6`) intact; warning pages correspond to image-only folios or library plates and do not impact narrative coverage. No new noise detected in `combined.md` or page-level Markdown.
- fixes_applied: None—validation-only run; documented confirmation within this log for downstream continuity.
- remaining_issues: Image-only folios still absent from Markdown; drop-cap ligatures persist until supplemental OCR is prioritized. Continue to monitor manifest page counts versus PDF metadata for discrepancies.
- next_steps: 1) Advance to Workstream B heading QA once stakeholders acknowledge image-folio limitations. 2) Consider scheduling optional OCR enhancement backlog item if future governance sources exhibit similar warning densities.

## 2025-11-16T00:35:00Z – Workstream B: Heading Verification & QA (prince01mach_1)
- tasks: Regenerated segmentation and structure artifacts for `prince01mach_1` (combined markdown) to validate ToC/heading coverage and confirm governance heuristics behave as expected against the latest parse.
- commands: `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract segments --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/segments.json --output-format json`; `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract structure --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/structure.json --output-format json`.
- verification: Both commands exited 0; `segments.json`/`structure.json` refreshed with unchanged checksums and 30 chapter headings preserved. Spot-checked offsets confirm anchors align with the chapter introductions and ToC paragraphs remain grouped under their parent headings.
- quality_review: Duplicate `CONTENTS` and `PREFACE` headings persist from front-matter repetitions, and the ToC block is still emitted as a single paragraph, but chapter hierarchy and statute-style markers stay accurate. No new noise introduced.
- fixes_applied: None required—QA pass only; duplicates documented as backlog for future parser cleanup.
- remaining_issues: Need upstream Markdown normalization to dedupe repeated front-matter headings and break the ToC paragraph into list items for downstream consumers.
- next_steps: 1) Evaluate Markdown normalization options before processing HTML statutes. 2) Once dedupe backlog is addressed or accepted, proceed to Workstream C entity/taxonomy enhancements specific to governance corpus.

## 2025-11-16T03:20:00Z – Workstream A: prince01mach_1 Parse Revalidation
- tasks: Forced a fresh parse of `prince01mach_1.pdf` via the canonical CLI entry to confirm Workstream A coverage for the Machiavelli baseline and re-reviewed representative pages for OCR fidelity.
- commands: `/home/ubuntu/speculum-principum/.venv/bin/python -m main parse --output-root evidence/parsed --force pdf evidence/prince01mach_1.pdf`.
- verification: Command exited 0; manifest at `evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/index.md` regenerated with checksum `1327a866df4a9ac3dc17963ca19ce7aa033bbd10debc9d073319e72c523a3ed3`, 150 Markdown pages, and the expected warning set (pages 1, 3, 4, 6, 16, 153, 154, 158 lacking extractable text).
- quality_review: Spot-checked `page-005.md`, `page-150.md`, and the top of `combined.md`; OCR remains legible with known ligature artifacts (`NICCOL6`, dotted leader lines) and page 150 retains the archival stamp string. No new truncation or garbled text observed.
- fixes_applied: None—validation-only run; existing README annotations already capture warning rationale and checksum history.
- remaining_issues: Image-only folios and drop-cap ligatures remain unsolved; supplemental OCR or manual transcription still required if higher fidelity is demanded. Workstream A document list task remains blocked pending intake of the two outstanding governance sources.
- next_steps: 1) Coordinate intake or scope adjustment for the remaining governance documents. 2) Upon resolution, continue with the next Workstream once current section criteria are satisfied.

## 2025-11-16T03:35:00Z – Workstream B: prince01mach_1 Segmentation QA
- tasks: Regenerated `segments` and `structure` artifacts for `prince01mach_1` to reconfirm heading heuristics after the latest parse cycle and scanned outputs for duplicated or malformed entries.
- commands: `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract segments --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/segments.json --output-format json`; `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract structure --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/structure.json --output-format json`.
- verification: Both commands exited 0 and rewrote the existing artifacts; `segment_counts.heading` remains 30 with chapter offsets aligned to the structure manifest, matching prior baselines.
- quality_review: Outputs still include duplicated front-matter headings (`CONTENTS`, `PREFACE`, `PREFACE vii`) and the TOC paragraph surfaces as a single long segment. OCR asterisks (`CHAPTER XI*`, `CHAPTER XXV^`) persist. No new noise detected in body chapters.
- fixes_applied: None required—QA-only regeneration to validate stability after parse rerun.
- remaining_issues: Need upstream Markdown normalization to dedupe repeated front matter and split TOC lines; consider sanitizing OCR artifacts (`*`, `^`) during future cleanup pass.
- next_steps: 1) Determine whether TOC normalization should happen in parsing or segmentation before onboarding statute-heavy docs. 2) Proceed to Workstream C tasks once normalization decision is documented or deferred.

## 2025-11-16T03:55:00Z – Workstream C: prince01mach_1 Entity/Relationship/Taxonomy Pass
- tasks: Regenerated entities, relationships, and taxonomy outputs for `prince01mach_1`, then ran the composite benchmark profile to verify latency and stability ahead of governance extractor tuning.
- commands: `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract entities --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/entities.json --output-format json`; `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract relationships --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/relationships.json --output-format json`; `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract taxonomy --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/taxonomy.json --output-format json`; `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract-benchmark entities relationships taxonomy --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/benchmark_entities_relationships_taxonomy.yaml --output-format yaml`.
- verification: All commands exited 0. Benchmark averages: entities 0.0258s, relationships 0.0359s, taxonomy 0.1496s (within prior governance-default profile tolerances). Output checksums unchanged.
- quality_review: Entities capture expected Renaissance actors and geographies (Florence, France, Cesare Borgia); residual OCR ligature (`NICCOL6`) is filtered in metadata but raw text persists. Relationship graph still surfaces mirrored edges (Syracuse↔Carthaginians) and clustered opposition edges; generic municipal topics absent because taxonomy remains tuned for historical themes (economy label at 0.25 still marginally relevant). No evidence of regression in demonym canonicalization.
- fixes_applied: None—the run reuses existing heuristics. No new maps for U.S. states/agencies added yet.
- remaining_issues: Need dedicated governance lexicons (US states/counties/agencies) before applying this profile to modern documents; relationship dedupe/backoff still backlog; taxonomy lacks municipal service labels outlined in the plan.
- next_steps: 1) Draft or source U.S. governance location/agency maps ahead of the next corpus run. 2) Prototype relationship deduplication heuristics or weighting before moving to Workstream D modernization tasks.

## 2025-11-16T04:10:00Z – Workstream D: prince01mach_1 Metadata/Summary/Linking QA
- tasks: Regenerated metadata, summarization, and linking outputs for `prince01mach_1`, inspected JSON payloads for drift, and confirmed glossary-driven outbound links still resolve.
- commands: `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract metadata --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/metadata.json --output-format json`; `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract summarization --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/summarization.json --output-format json`; `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract linking --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/linking.json --output-format json`.
- verification: Commands exited 0; artifacts refreshed with the same checksum input. Metadata keywords remain eight entries with stopword filter applied, summary emits four taxonomy-aligned bullets, and linking retains 28 anchors plus five outbound glossary references.
- quality_review: Metadata title/subjects hold steady; keyword list includes borderline filler "before" that slipped past the >=6 character rule—acceptable but noted. Summary bullets stay on-goal though still tailored to historical taxonomy rather than civic governance. Linking anchors mirror structure duplication (`CONTENTS`, `PREFACE`), and outbound contexts remain front-matter heavy because glossary matches early mentions.
- fixes_applied: None—validation pass only; QA report `reports/quality-7.md` already reflects prior snapshot and remains accurate.
- remaining_issues: Need civic-specific metadata subjects/keyword seeds before scaling to modern corpus; might adjust keyword filter to drop common adverbs like "before". Linking could benefit from anchor dedupe and varied context windows to avoid repeated front-matter quotes.
- next_steps: 1) Draft civic metadata/summary templates aligned with Workstream D plan items. 2) Experiment with anchor dedupe or deeper context slicing ahead of governance document onboarding.

## 2025-11-16T04:25:00Z – Workstream E: prince01mach_1 Regression & Benchmark Refresh
- tasks: Re-ran targeted pytest suites plus governance benchmark profiles to ensure regression harness coverage stayed intact after the latest extractor passes.
- commands: `/home/ubuntu/speculum-principum/.venv/bin/python -m pytest tests/extraction/test_cli.py tests/extraction/test_metadata.py tests/extraction/test_summarization.py tests/extraction/test_entities.py tests/extraction/test_relationships.py`; `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract-benchmark --profile governance-default --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/benchmark_governance_default.yaml --output-format yaml`; `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract-benchmark --profile governance-full --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/benchmark_governance_full.yaml --output-format yaml`.
- verification: Pytest reported 25 passes (CLI + extractor suites). Governance-default benchmark averages: entities 0.0253s, relationships 0.0324s, metadata 0.0182s, summarization 0.0028s. Governance-full adds taxonomy 0.1386s and linking 0.0157s—both within prior logs.
- quality_review: Regression harness continues to lock metadata/summarization/relationship behaviors; benchmark drift well under 5% from earlier entries. Full profile confirms linking latency remains low despite glossary references. No artifact corruption observed.
- fixes_applied: None—instrumentation only; refreshed benchmark YAMLs stored alongside prior outputs for diffing.
- remaining_issues: Need documentation update so future agents know to run `governance-full` during scheduled QA; still missing automation to publish benchmark deltas to the quality report.
- next_steps: 1) Capture doc instructions for profile usage in enablement notes/plan. 2) Consider script to summarize benchmark trends in `reports/quality-*.md` to satisfy Workstream E reporting goals.

## 2025-11-16T00:48:00Z – Workstream A: Corpus Inventory Recheck
- tasks: Re-audited `evidence/` to confirm available governance documents beyond `prince01mach_1.pdf` and reconciled findings with the sprint plan’s document-list requirement.
- commands: None (filesystem inspection).
- verification: Identified additional sources already staged locally—`Agriculture, Water & Natural Resources.htm`, `application_of_the_colorado_common_interest_ownership_act_ccioa_in_hoa_communities_-_colorado_law_summary.pdf`, and `fy25-26apprept.pdf`. No other governance documents located, leaving the corpus at four total items.
- quality_review: Existing plan entry overstated the limitation to a single PDF; corrected to reflect current inventory while highlighting the gap versus the six-source target.
- fixes_applied: Updated `devops/projects/governance-extraction-plan.md` to reopen the document-list task with an explicit note on the four staged sources and the two outstanding downloads.
- remaining_issues: Need to identify/download the missing constitution/charter/code/budget/agreements to satisfy the six-source coverage goal or formally adjust the scope.
- next_steps: 1) Coordinate intake of the remaining two governance documents (per sprint brief) or document the scope change. 2) Once corpus is complete, rerun parse/QA steps for the newly added files before advancing other workstreams.

## 2025-11-16T00:55:00Z – Workstream A: Plan Alignment with Current Corpus
- tasks: Updated the sprint plan to explicitly state that the next execution steps will proceed with the four staged governance documents while the final two remain on the intake backlog.
- commands: None (documentation edit only).
- verification: `devops/projects/governance-extraction-plan.md` now notes the active document set and clarifies that remaining sources are pending download.
- quality_review: Plan reflects actionable scope without overselling completion; stakeholders can track backlog gap directly from the plan.
- fixes_applied: Adjusted Workstream A document-list bullet with the current corpus note.
- remaining_issues: Missing downloads still block closure of the document-list task; need owner assignment for sourcing.
- next_steps: 1) Obtain the two outstanding governance documents or adjust success criteria. 2) Kick off parsing for the staged HTML/PDF sources using the Workstream A flow once intake decision is made.

## 2025-11-16T01:30:00Z – Workstream A: Multi-Document Parse & QA Cycle
- tasks: Forced fresh parses for all staged governance documents (HTML committee page, HOA law summary PDF, FY25-26 appropriation report PDF, existing Machiavelli baseline already confirmed) and reviewed generated artifacts for fidelity/noise.
- commands: `/home/ubuntu/speculum-principum/.venv/bin/python -m main parse --output-root evidence/parsed --force web "/home/ubuntu/speculum-principum/evidence/Agriculture, Water & Natural Resources.htm"`; `/home/ubuntu/speculum-principum/.venv/bin/python -m main parse --output-root evidence/parsed --force pdf /home/ubuntu/speculum-principum/evidence/application_of_the_colorado_common_interest_ownership_act_ccioa_in_hoa_communities_-_colorado_law_summary.pdf`; `/home/ubuntu/speculum-principum/.venv/bin/python -m main parse --output-root evidence/parsed --force pdf /home/ubuntu/speculum-principum/evidence/fy25-26apprept.pdf`.
- verification: All commands exited 0; corresponding manifests refreshed under `evidence/parsed/2025/` with updated timestamps and consistent checksums (`96e86481f6ed…`, `1fd3070980ab…`, `90c4d8d76e61…`). No parser warnings emitted.
- quality_review: HTML capture retains committee roster/schedule content but preserves table rows as stacked paragraphs—flagging for potential selector/markdown tweaks before downstream extraction. HOA summary PDF yields legible text with expected hyphenation artifacts yet maintains statutory citations; FY25-26 budget book exposes full 184-page index though dotted leader lines appear as repeated punctuation. No blank or garbled pages observed in sampled outputs (HTML segment, PDF pages 1/2, 5/10, 75/120).
- fixes_applied: None yet—data review only. Noted HTML table flattening and PDF dotted leaders as backlog items for parser/extractor normalization.
- remaining_issues: Need strategy to restore table structure (committee roster) and optionally normalize dotted ToC leader strings; hyphenation cleanup deferred to extraction stage. Two governance sources still outstanding from initial corpus list.
- next_steps: 1) Decide whether to introduce HTML selector overrides or post-processing to emit structured tables before segmentation. 2) After intake backlog resolved, continue Workstream A by annotating README updates (already current) and then transition to Workstream B for the newly parsed governance artifacts.

## 2025-11-16T02:50:00Z – Workstream A: HTML Key-Value Table Normalization
- tasks: Implemented BeautifulSoup-based pre-processing in the web parser to rewrite two-column key-value tables into semantic paragraphs/lists prior to Trafilatura extraction, installed the new dependency, re-ran the Agriculture committee parse, and refreshed README notes.
- commands: `pip install 'beautifulsoup4>=4.12.2'` (via automation); `/home/ubuntu/speculum-principum/.venv/bin/python -m main parse --output-root evidence/parsed --force web "/home/ubuntu/speculum-principum/evidence/Agriculture, Water & Natural Resources.htm"`; `/home/ubuntu/speculum-principum/.venv/bin/python -m pytest tests/parsing`.
- verification: Parse exited 0; `evidence/parsed/2025/agriculture-water-natural-resources-htm-96e86481f6ed/segment-001.md` now renders the `Subjects` block as a bulleted list, confirming the normalization hook triggered. Checksum unchanged due to stable source file. Targeted pytest suite (`tests/parsing`) passes (40 tests) validating parser behavior.
- quality_review: Key-value blocks convert cleanly to Markdown bullets; no extra whitespace or duplicate content observed. Other page content unaffected, preserving committee rosters and schedules exactly as before. `README.md` updated to record the new behavior.
- fixes_applied: Added BeautifulSoup dependency to `requirements.txt`, extended `src/parsing/web.py` with `_rewrite_key_value_tables`, and documented the normalization in `evidence/parsed/README.md`.
- remaining_issues: Need to evaluate additional committee/agency pages to ensure the heuristic doesn’t miss multi-column tables or over-normalize complex layouts. Future enhancement: extend normalization to roster grids or fallback to Markdown tables when there are >2 columns.
- next_steps: 1) Spot-check other governance HTML sources once staged to verify the pre-processor holds up. 2) Resume Workstream B segmentation tasks for the newly parsed documents after confirming HTML normalization coverage.

## 2025-11-16T05:32:00Z – Workstream C: U.S. Governance Coverage Enhancements
- tasks: Externalized U.S. state/county/agency location maps, wired the entity extractor to load known GPEs, demonyms, and organizations from YAML, expanded relationship keyword families (oversight, funding, delegation, emergency powers), added civic-focused taxonomy categories, regenerated extractor outputs for the staged governance corpus, and benchmarked the updated profile.
- commands: `/home/ubuntu/speculum-principum/.venv/bin/python -m pytest tests/extraction/test_entities.py`; `/home/ubuntu/speculum-principum/.venv/bin/python -m pytest tests/extraction/test_relationships.py`; `/home/ubuntu/speculum-principum/.venv/bin/python -m pytest tests/extraction/test_taxonomy.py`; `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract entities --input evidence/parsed/2025/application-of-the-colorado-common-interest-owne-1fd3070980ab --output evidence/parsed/2025/application-of-the-colorado-common-interest-owne-1fd3070980ab/outputs/entities.json --output-format json`; `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract relationships --input evidence/parsed/2025/application-of-the-colorado-common-interest-owne-1fd3070980ab --output evidence/parsed/2025/application-of-the-colorado-common-interest-owne-1fd3070980ab/outputs/relationships.json --output-format json`; `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract taxonomy --input evidence/parsed/2025/application-of-the-colorado-common-interest-owne-1fd3070980ab --output evidence/parsed/2025/application-of-the-colorado-common-interest-owne-1fd3070980ab/outputs/taxonomy.json --output-format json`; `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract entities --input evidence/parsed/2025/agriculture-water-natural-resources-htm-96e86481f6ed --output evidence/parsed/2025/agriculture-water-natural-resources-htm-96e86481f6ed/outputs/entities.json --output-format json`; `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract taxonomy --input evidence/parsed/2025/agriculture-water-natural-resources-htm-96e86481f6ed --output evidence/parsed/2025/agriculture-water-natural-resources-htm-96e86481f6ed/outputs/taxonomy.json --output-format json`; `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract entities --input evidence/parsed/2025/fy25-26apprept-pdf-90c4d8d76e61 --output evidence/parsed/2025/fy25-26apprept-pdf-90c4d8d76e61/outputs/entities.json --output-format json`; `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract relationships --input evidence/parsed/2025/fy25-26apprept-pdf-90c4d8d76e61 --output evidence/parsed/2025/fy25-26apprept-pdf-90c4d8d76e61/outputs/relationships.json --output-format json`; `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract taxonomy --input evidence/parsed/2025/fy25-26apprept-pdf-90c4d8d76e61 --output evidence/parsed/2025/fy25-26apprept-pdf-90c4d8d76e61/outputs/taxonomy.json --output-format json`; `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract-benchmark --profile governance-full --input evidence/parsed/2025/application-of-the-colorado-common-interest-owne-1fd3070980ab --output evidence/parsed/2025/application-of-the-colorado-common-interest-owne-1fd3070980ab/outputs/benchmark_governance_full.yaml --output-format yaml`; `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract-benchmark --profile governance-full --input evidence/parsed/2025/agriculture-water-natural-resources-htm-96e86481f6ed --output evidence/parsed/2025/agriculture-water-natural-resources-htm-96e86481f6ed/outputs/benchmark_governance_full.yaml --output-format yaml`; `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract-benchmark --profile governance-full --input evidence/parsed/2025/fy25-26apprept-pdf-90c4d8d76e61 --output evidence/parsed/2025/fy25-26apprept-pdf-90c4d8d76e61/outputs/benchmark_governance_full.yaml --output-format yaml`.
- verification: All pytest runs passed (entities/relationships/taxonomy suites). Extraction and benchmark commands exited 0 and generated artifacts under each document’s `outputs/` directory. Entities now surface `Department of Transportation`, `Department of Public Health`, and `State of Colorado` with `known_organization`/`known_location` metadata; demonym metadata returns canonical `Texas` when triggered in fixtures. Relationship payloads include the new `funding`, `oversight`, and `emergency_powers` relation types; taxonomy outputs rank the added civic categories with `fiscal_governance` scoring 0.053 on the HOA memo and `municipal_services` at 0.081 on the budget report. Benchmarks recorded mean latencies (entities: 0.0139s for HOA memo, 0.0114s for committee HTML, 0.2023s for budget book) within ±10% of Prince baselines while taxonomy pacing (0.6029s on the budget book) remains acceptable for full runs.
- quality_review: U.S. agencies are now classified as ORG instead of defaulting to PERSON, and location detection covers state/county references; however statutes and table headers still surface as PERSON entities (`Colorado Law Summary`, `Contract true up`) due to capitalized sequence heuristics. Relationship outputs capture fiscal tables but continue to emit noisy object spans (“State Education Fund Item FY 2024-25…”); oversight category sometimes anchors to generic nouns (“Contract” → “Market”). Taxonomy successfully flags civic themes yet municipal scores remain low on HTML agendas because the parser collapses table headings into sentence fragments.
- fixes_applied: Updated `src/extraction/entities.py` to load YAML-backed location/demonym/organization maps, created `config/normalization_maps/us_locations.yaml`, `config/normalization_maps/us_demonyms.yaml`, and `config/normalization_maps/us_agencies.yaml`, expanded `config/extraction.yaml` relationship keyword families and taxonomy categories, and added regression coverage in `tests/extraction/test_entities.py`. Refreshed extractor outputs and governance benchmark YAMLs for the HOA memo, committee HTML, and budget report.
- remaining_issues: Need follow-up heuristics to down-rank capitalized statute titles and table headings that masquerade as PERSON entities; relationship extractor still requires slice trimming to avoid entire table captions and should add delegation-specific evidence once corpus examples surface; taxonomy recall on HTML agendas depends on upstream segmentation that emits structured labels. Consider expanding demonym coverage for county-level residents (e.g., “Angelenos”) once actual corpora demand it.
- next_steps: 1) Prototype post-processing to trim relationship objects/subjects to clause boundaries before scaling benchmarks. 2) Invest in segmentation/Markdown cleanup so committee agendas expose bullet lists, unlocking stronger `municipal_services` scores and reducing PERSON misclassifications. 3) Gather real governance documents mentioning delegation to validate that keyword family produces signal before locking regression tests.

## 2025-11-16T19:30:00Z – Workstream D: Metadata/Summary/Linking Governance Re-tune (prince01mach_1)
- tasks: Updated metadata subjects/description for civic framing, expanded summarization templates to include structural insight, integrated a governance reference glossary for linking, and regenerated artifacts for prince01mach_1.
- commands: `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract metadata --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --config config/extraction.yaml --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/metadata.json`; `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract summarization --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --config config/extraction.yaml --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/summarization.json`; `/home/ubuntu/speculum-principum/.venv/bin/python -m main extract linking --input evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/combined.md --config config/extraction.yaml --output evidence/parsed/2025/prince01mach-1-pdf-1327a866df4a/outputs/linking.json`.
- verification: All three runs exited 0, regenerated artifacts reference checksum 9b220b0b202eb94c76596320fa7b3cb6, and manual diff confirmed only the intended subject/bullet/link changes; outbound link review showed no false positives after glossary integration.
- quality_review: Metadata subjects now emphasize executive governance, fiscal policy, and intergovernmental coordination while retaining accurate provenance; summary emits five governance-focused bullets including structural notes; linking anchors unchanged but outbound glossary remains limited to historically relevant figures (no noise introduced).
- fixes_applied: Edited `config/extraction.yaml` metadata/summary/linking blocks, added `config/normalization_maps/us_governance_glossary.yaml`, and refreshed `metadata.json`, `summarization.json`, and `linking.json`.
- remaining_issues: Metadata keywords still include filler token "before"; duplicated `CONTENTS`/`PREFACE` anchors persist; governance glossary needs additional modern agency/statute entries once new corpus items arrive.
- next_steps: 1) Extend stopword list to drop residual adverbs like "before" during the next metadata tuning pass. 2) Propagate the updated templates/glossary to other governance documents once their Workstream D tasks begin.
